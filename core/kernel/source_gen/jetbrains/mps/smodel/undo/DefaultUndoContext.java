package jetbrains.mps.smodel.undo;

/*Generated by MPS */

import org.jetbrains.mps.openapi.module.SRepository;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import jetbrains.mps.smodel.SNodeUndoableAction;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.internal.collections.runtime.ITranslator2;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;

public class DefaultUndoContext implements UndoContext {
  private final SRepository myRepository;

  public DefaultUndoContext(@NotNull SRepository repository) {
    myRepository = repository;
  }

  @Override
  public Iterable<SNode> getVirtualFileNodes(List<SNodeUndoableAction> actions) {
    return ListSequence.fromList(actions).translate(new ITranslator2<SNodeUndoableAction, SNode>() {
      public Iterable<SNode> translate(SNodeUndoableAction it) {
        return getVirtualFileNodes(it);
      }
    });
  }

  @Override
  public Iterable<SNode> getVirtualFileNodes(SNodeUndoableAction action) {
    return Sequence.<SNode>singleton(SNodeOperations.getContainingRoot((SNode) action.getAffectedNode()));
  }

  @Override
  @NotNull
  public SRepository getRepository() {
    return myRepository;
  }
}
