package jetbrains.mps.checkers;

/*Generated by MPS */

import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.annotations.Nullable;
import org.jetbrains.mps.openapi.model.SNodeReference;
import jetbrains.mps.errors.messageTargets.NodeMessageTarget;
import jetbrains.mps.errors.messageTargets.MessageTarget;
import jetbrains.mps.errors.QuickFixProvider;
import jetbrains.mps.errors.SimpleErrorReporter;
import jetbrains.mps.errors.MessageStatus;
import jetbrains.mps.errors.item.TypesystemReportItemAdapter;
import jetbrains.mps.errors.item.NodeReportItem;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;

public abstract class LanguageErrorsCollector {

  public void addErrorWithoutDependencies(@NotNull SNode node, String errorString, @Nullable SNodeReference ruleNode) {
    addErrorWithoutDependencies(node, errorString, ruleNode, new NodeMessageTarget());
  }

  public void addErrorWithoutDependencies(@NotNull SNode errorNode, String errorString, @Nullable SNodeReference ruleNode, MessageTarget messageTarget) {
    addErrorWithoutDependencies(errorNode, errorString, ruleNode, messageTarget, null);
  }

  private void addErrorWithoutDependencies(@NotNull SNode errorNode, String errorString, @Nullable SNodeReference ruleNode, MessageTarget messageTarget, QuickFixProvider intentionProvider) {
    SimpleErrorReporter reporter = new SimpleErrorReporter(errorNode, errorString, ruleNode, MessageStatus.ERROR, messageTarget);
    if (intentionProvider != null) {
      reporter.setIntentionProvider(intentionProvider);
    }

    addErrorInternal(new TypesystemReportItemAdapter(reporter));
  }

  public void addError(NodeReportItem reportItem) {
    addErrorInternal(reportItem);
  }

  protected abstract void addErrorInternal(NodeReportItem reportItem);

  public void addDependency(SNode dependency) {
  }

  public <Result> Result runCheckingAction(_FunctionTypes._return_P0_E0<? extends Result> action) {
    return action.invoke();
  }

}
