package jetbrains.mps.checkers;

/*Generated by MPS */

import jetbrains.mps.errors.item.ReportItem;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import org.jetbrains.mps.openapi.module.SRepository;
import org.jetbrains.mps.openapi.util.Consumer;
import org.jetbrains.mps.openapi.util.ProgressMonitor;

public class FilteringChecker<O, I extends ReportItem> implements IChecker<O, I> {
  private IChecker<O, I> myOrigin;
  private _FunctionTypes._return_P2_E0<? extends Boolean, ? super I, ? super SRepository> myAccept;
  public FilteringChecker(IChecker origin, _FunctionTypes._return_P2_E0<? extends Boolean, ? super I, ? super SRepository> accept) {
    myOrigin = origin;
    myAccept = accept;
  }
  @Override
  public void check(O toCheck, final SRepository repository, final Consumer<I> errorCollector, ProgressMonitor monitor) {
    Consumer<I> consumer = new Consumer<I>() {
      public void consume(I item) {
        if (myAccept.invoke(item, repository)) {
          errorCollector.consume(item);
        }
      }
    };
    myOrigin.check(toCheck, repository, consumer, monitor);
  }
}
