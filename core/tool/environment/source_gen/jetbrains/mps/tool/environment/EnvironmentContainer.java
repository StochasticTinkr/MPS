package jetbrains.mps.tool.environment;

/*Generated by MPS */

import jetbrains.mps.util.annotation.ToRemove;
import org.jetbrains.annotations.Nullable;
import org.jetbrains.annotations.NotNull;

/**
 * This class is to store the current environment (e.g used in tests, ant tasks etc.)
 * Note that there is only one possible environment at the same moment
 * 
 * @deprecated Code that needs an Environment have to receive proper instance from external code (e.g. with a mechanism like dependency injection) rather than to assume the right instance is available from global singleton.
 */
@Deprecated
@ToRemove(version = 2018.1)
public final class EnvironmentContainer {
  private static Environment ourCurrent;

  @Deprecated
  private EnvironmentContainer() {
  }

  @Nullable
  public synchronized static Environment get() {
    return ourCurrent;
  }

  /*package*/ synchronized static void setCurrent(@NotNull Environment env) {
    if (EnvironmentContainer.ourCurrent != null) {
      throw new IllegalStateException("Another environment is active: " + EnvironmentContainer.ourCurrent);
    }
    EnvironmentContainer.ourCurrent = env;
  }

  /*package*/ synchronized static void clear() {
    if (ourCurrent == null) {
      throw new IllegalStateException("No active environment currently");
    }
    EnvironmentContainer.ourCurrent = null;
  }
}
