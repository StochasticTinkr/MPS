package jetbrains.mps.ide.migration.wizard;

/*Generated by MPS */

import jetbrains.mps.project.Project;
import jetbrains.mps.lang.migration.runtime.base.Problem;
import com.intellij.openapi.progress.ProgressIndicator;
import org.jetbrains.mps.openapi.module.SModule;
import jetbrains.mps.migration.component.util.MigrationsUtil;
import jetbrains.mps.ide.migration.check.MigrationCheckUtil;
import jetbrains.mps.progress.ProgressMonitorAdapter;

public class PreCheckError extends MigrationError {
  private boolean myCanIgnore;
  private Project myProject;
  public PreCheckError(Project p, boolean canIgnore) {
    myCanIgnore = canIgnore;
    myProject = p;
  }
  public String getMessage() {
    return "Migration Assistant found some problems in the project.<br><br>" + "It is recommended to fix problems before starting the migration.<br>";
  }
  public Iterable<Problem> getProblems(ProgressIndicator progressIndicator) {
    Iterable<SModule> modules = MigrationsUtil.getMigrateableModulesFromProject(myProject);
    return MigrationCheckUtil.getProblems(modules, new ProgressMonitorAdapter(progressIndicator), 100);
  }

  @Override
  public boolean canIgnore() {
    return myCanIgnore;
  }
}
