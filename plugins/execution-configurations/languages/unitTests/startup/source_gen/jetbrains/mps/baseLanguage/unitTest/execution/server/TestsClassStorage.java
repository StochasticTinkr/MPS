package jetbrains.mps.baseLanguage.unitTest.execution.server;

/*Generated by MPS */

import org.jetbrains.annotations.Nullable;
import org.jetbrains.mps.openapi.module.SModule;
import jetbrains.mps.module.ReloadableModule;
import org.apache.log4j.Logger;
import org.apache.log4j.LogManager;
import org.apache.log4j.Level;

public class TestsClassStorage {
  @Nullable
  private Class<?> tryLoadTestClass(String fqName, SModule module) {
    if (module instanceof ReloadableModule && ((ReloadableModule) module).willLoad()) {
      Class<?> aClass;
      try {
        aClass = ((ReloadableModule) module).getOwnClass(fqName);
      } catch (ClassNotFoundException ignored) {
        aClass = null;
      }
      return aClass;
    }
    return null;
  }

  protected static Logger LOG = LogManager.getLogger(TestsClassStorage.class);
  @Nullable
  public Class<?> loadTestClass(String fqName, SModule module) {
    final Class<?> aClass = tryLoadTestClass(fqName, module);
    if (aClass == null) {
      if (LOG.isEnabledFor(Level.ERROR)) {
        LOG.error("Test class " + fqName + " was not found. Possibly the solution which contains tests has plugin kind NONE. Try setting it to the plugin kind PLUGIN_OTHER.");
      }
    }
    return aClass;
  }
}
