package jetbrains.mps.ide.httpsupport.manager.plugin;

/*Generated by MPS */

import org.jetbrains.io.CustomPortServerManagerBase;

public class MPSIntegrationPortManager extends CustomPortServerManagerBase {

  public static final int PORT_FIRST = 63330;
  public static final int PORT_LAST = 63340;

  public int port = PORT_FIRST;

  @Override
  public int getPort() {
    return port;
  }

  @Override
  public void cannotBind(Exception e, int port) {
    if (port >= PORT_LAST) {
      this.port = -1;
      HttpSupportPliginNotifications.showWarning("Built-in server cannot bind to any port from" + PORT_FIRST + " to " + (PORT_LAST - 1) + ". Integration with YouTrack/TeamCity is disabled ");
    } else {
      this.port = port + 1;
      portChanged();
    }
  }

  @Override
  public boolean isAvailableExternally() {
    return true;
  }

  public static int getCurrentPort() {
    return EP_NAME.findExtension(MPSIntegrationPortManager.class).getPort();
  }
}
