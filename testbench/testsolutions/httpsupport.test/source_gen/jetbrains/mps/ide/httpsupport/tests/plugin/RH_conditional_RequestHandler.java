package jetbrains.mps.ide.httpsupport.tests.plugin;

/*Generated by MPS */

import jetbrains.mps.ide.httpsupport.runtime.base.HttpRequestHandlerBase;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.ide.httpsupport.manager.plugin.HttpRequest;
import io.netty.handler.codec.http.HttpResponseStatus;
import io.netty.buffer.Unpooled;
import io.netty.util.CharsetUtil;

public class RH_conditional_RequestHandler extends HttpRequestHandlerBase {

  private static final List<String> QUERY_PREFIX = ListSequence.fromListAndArray(new ArrayList<String>(), "handlerTest", "conditional");

  private final boolean myCorrectRequest;
  private final String param;

  public RH_conditional_RequestHandler(HttpRequest request) {
    super(request);
    boolean correctRequest = true;
    {
      String param_serialized = ListSequence.fromList(this.request.getParameterValue("param")).getElement(0);
      if (param_serialized != null) {
        this.param = param_serialized;
      } else {
        this.param = null;
      }
    }
    myCorrectRequest = correctRequest;
  }


  @Override
  protected List<String> getQueryPrefix() {
    return QUERY_PREFIX;
  }


  @Override
  public boolean canHandle() {
    if (!(myCorrectRequest) || !(super.canHandle())) {
      return false;
    }

    return this.param.equals("param");
  }

  @Override
  public void handle() throws Exception {
    this.request.sendResponse(HttpResponseStatus.OK, "text/plain", Unpooled.copiedBuffer("handled", CharsetUtil.UTF_8));
  }
}
