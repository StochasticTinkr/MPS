<component xmlns:xi="http://www.w3.org/2001/XInclude">

  <xi:include href="/idea/PlatformActions.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="/idea/VcsActions.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="/idea/MPSLangActions.xml" xpointer="xpointer(/component/*)"/>

  <actions>

    <!-- File -->
    <group id="OpenProjectGroup">
      <group id="NewElementInMenuGroup" class="com.intellij.ide.actions.NewActionGroup" text="New" popup="true"/>
      <add-to-group group-id="FileOpenGroup" anchor="first"/>
    </group>

    <action id="NewElement" class="com.intellij.ide.actions.NewElementAction"/>

    <group id="NewProjectOrModuleGroup">
      <!--MPS Patch-->
      <action id="NewProject" class="jetbrains.mps.workbench.actions.NewMPSProjectAction" text="New MPS Project"/>
      <!--
      <action id="NewProject" class="com.intellij.ide.actions.NewProjectAction" text="Project..."/>
      <action id="ImportProject" class="com.intellij.ide.actions.ImportProjectAction" text="Project from Existing Sources..."/>
      <group id="NewProjectFromVCS" class="com.intellij.openapi.vcs.checkout.NewProjectFromVCSGroup" text="Project from Version Control" popup="true"/>
      <separator/>
      <action id="NewModule" class="com.intellij.openapi.roots.ui.configuration.actions.NewModuleAction" text="Module..."/>
      <action id="ImportModule" class="com.intellij.ide.actions.ImportModuleAction" text="Module from Existing Sources..."/>
      <separator/>
      -->
    </group>

    <group>
      <add-to-group group-id="ExportImportGroup" anchor="first"/>
    </group>
    <action id="SaveAsNewFormat" class="com.intellij.ide.actions.SaveAsDirectoryBasedFormatAction" text="Save as Directory-Based Format...">
      <add-to-group group-id="ExportImportGroup" anchor="last"/>
    </action>

    <!-- Analyze -->
    <group id="AnalyzeActions">
    </group>

    <group id="AnalyzeMenu" popup="true">
      <separator/>
      <reference ref="AnalyzeActions"/>
      <add-to-group group-id="MainMenu" anchor="after" relative-to-action="CodeMenu"/>
    </group>

    <group id="BuildMenu" popup="true">
      <add-to-group group-id="MainMenu" anchor="before" relative-to-action="RunMenu"/>
    </group>

    <!-- Help -->
    <action id="WhatsNewAction" class="com.intellij.ide.actions.WhatsNewAction">
      <add-to-group group-id="HelpMenu" anchor="after" relative-to-action="ShowTips"/>
    </action>

    <!-- TODO: Enable actions and references after replacing all IDEA actions with MPS ones -->
    <group id="TouchBarDefault" text="Default">
      <!--
      <reference ref="CompileDirty"/>
      <reference ref="RunConfiguration"/>
      -->
      <group id="RunnerActionsTouchbar"/> <!--filled from ExecutorRegistry-->
      <!--
      <reference ref="Stop"/>
      <separator/>
      <reference ref="Vcs.UpdateProject"/>
      <reference ref="CheckinProject"/>
      -->
      <add-to-group group-id="TouchBar" anchor="before" relative-to-action="TouchBarDebugger"/>
      <group id="TouchBarDefault_alt" text="Default with Alt key">
        <!--
        <separator text="type.flexible"/>
        <reference ref="RevealGroup"/>
        -->
      </group>
      <group id="TouchBarDefault_cmd" text="Default with Cmd key">
        <!--Use Cmd modifier key to show Navigation buttons, Bookmark and Breakpoint toggles and to Show Usages/-->
        <!--Cmd key is used, because itâ€™s used in most of the action shortcuts: Back/Forward, Breakpoint and Find Usages./-->
        <!--
        <reference ref="Back"/>
        <reference ref="Forward"/>
        <separator text="type.big"/>
        <reference ref="ToggleBookmark"/>
        <reference ref="ToggleLineBreakpoint"/>
        <separator text="type.flexible"/>
        <reference ref="FindUsages"/>
        -->
      </group>
      <group id="TouchBarDefault_cmd.alt" text="Default with Alt+Cmd key">
        <!--
        <separator text="type.flexible"/>
        <reference ref="ShowUsages"/>
        -->
      </group>
      <group id="TouchBarDefault_shift" text="Default with Shift key">
        <!--Use Shift to show Refactor actions/-->
        <!--
        <reference ref="RenameElement"/>
        <reference ref="ChangeSignature"/>
        <separator text="type.flexible"/>
        <reference ref="CopyElement"/>
        <reference ref="Move"/>
        -->
      </group>
    </group>
  </actions>
</component>