<project name="mpsMigration" default="checkAll" basedir="../..">
  <property name="env.JAVA_HOME" value="${java.home}/.."/>
  <property name="jdk.home" value="${env.JAVA_HOME}"/>

  <!--this will be specified by test.xml-->
  <property name="mps_build_home" location="build/artifacts/mps"/>

  <!--this is needed by migration task to run, see MPS-23341
      the section should be removed as soon as the issue is fixed
  -->
  <property name="mps_home" location="${mps_build_home}"/>
  <property name="build.dir" location="build"/>
  <property name="build.tmp" location="${build.dir}/tmp/mpsPlugins"/>
  <property name="artifacts.mps" location="${mps_build_home}"/>
  <property name="idea_home" location=""/>
  <property name="artifacts.mpsBootstrapCore" location="${build.dir}/artifacts/mpsBootstrapCore"/>
  <property name="artifacts.mpsCore" location="${build.dir}/artifacts/mpsCore"/>
  <property name="artifacts.IDEA" location="${idea_home}"/>

  <path id="path.mps.ant.path">
    <pathelement location="${mps_build_home}/lib/ant/lib/ant-mps.jar"/>
    <pathelement location="${mps_build_home}/lib/jdom.jar"/>
    <pathelement location="${mps_build_home}/lib/log4j.jar"/>
  </path>

  <taskdef name="custom" classname="jetbrains.mps.build.ant.CustomMPSLoadTask" classpathref="path.mps.ant.path"/>

  <property name="worker.class" value="jetbrains.mps.tool.builder.MpsWorkerTest"/>
  <property name="ref.baseLanguage" value="f3061a53-9226-4cc5-a443-f952ceaf5816(jetbrains.mps.baseLanguage)"/>


  <target name="checkAll">
    <custom mpshome="${mps_build_home}" worker="${worker.class}" args="${ref.baseLanguage} false">
      <jvmargs>
        <arg value="-Xmx1200m"/>
      </jvmargs>
      <repository/>
    </custom>
    <custom mpshome="${mps_build_home}" worker="${worker.class}" args="${ref.baseLanguage} true">
      <jvmargs>
        <arg value="-Xmx1200m"/>
      </jvmargs>
      <repository>
      <allmpsmodules/>
      </repository>
    </custom>
    <custom mpshome="${mps_build_home}" worker="${worker.class}" args="${ref.baseLanguage} true">
      <jvmargs>
        <arg value="-Xmx1200m"/>
      </jvmargs>
      <repository>
        <module file="${basedir}/languages/baseLanguage/baseLanguage/jetbrains.mps.baseLanguage.mpl"/>
      </repository>
    </custom>
    <custom mpshome="${mps_build_home}" worker="${worker.class}" args="${ref.baseLanguage} true">
      <jvmargs>
        <arg value="-Xmx1200m"/>
      </jvmargs>
      <repository>
        <modules dir="${basedir}/languages/baseLanguage/baseLanguage/"/>
      </repository>
    </custom>
  </target>
</project>